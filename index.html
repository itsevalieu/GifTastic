<!DOCTYPE html>
<html>
<head>
	<title>GifTastic</title>
	<link rel="stylesheet" href="assets/css/reset.css">
	<link rel="stylesheet" href="assets/css/style.css">
</head>
<body>
	<div id="animalButtons">
	</div>
	<form id="animal-form">
		<label for="animal-input">Add an animal</label>
		<input id="animal-input" type="text" name="name">
		<input id="addAnimal" type="submit" value="Submit">
	</form>
	<div id="animals">
	</div>


<script src="https://code.jquery.com/jquery-2.2.3.js" integrity="sha256-laXWtGydpwqJ8JA+X9x2miwmaiKhn8tVmOVEigRNtP4=" crossorigin="anonymous"></script>
<script>

var animalArray = [];
function renderButtons(){
	$("#animalButtons").empty();
	for(var i=0; i<animalArray.length; i++){
		var b = $("<button>"); //creating button div
		b.addClass("animal"); //assign class 'animal' to button
		b.attr("data-name", animalArray[i]); //assign attr data-name with animal names from array
		b.text(animalArray[i]);//display animal name in each button
		$("#animalButtons").append(b);//display each button to the id div called animalButtons
	}
}

$("#addAnimal").on("click", function(){
	var animal = $("#animal-input").val().trim();
	
	if(animal !== ""){
		animalArray.push(animal);
		console.log(animal);
		renderButtons();
	}

	$("#animal-input").val("");
	return false;
});

function displayAnimalGifs(){
	var animalName = $(this).data("name");
	var queryURL = "http://api.giphy.com/v1/gifs/search?q=" + animalName + "&limit=5&api_key=dc6zaTOxFJmzC";
	$.ajax({url: queryURL,
			method: "GET"})
	.done(function(response){
		console.log(response);
		
		var results = response.data;
		for(var a=0; a< results.length; a++){
			var p = $("<p>").text("Rating: "+ results[a].rating);
			var img = $("<img>");
			img.attr("src", results[a].images.fixed_height_still.url);
			img.attr("alt", "animal gif");
			img.attr("data-still", results[a].images.fixed_height_still.url);
			img.attr("data-animate", results[a].images.fixed_height.url);
			img.attr("data-state", "still");
			img.addClass("gif");

			var animalInfo = $("<div>");

			animalInfo.append(p);
			animalInfo.append(img);
			$("#animals").prepend(animalInfo);
		}
	});
	console.log(queryURL);
}

$(document).on("click", ".animal", displayAnimalGifs);

$(".gif").on("click", function(){
	var state = $(this).attr("data-state");
	if(state === "still"){
		$(this).attr("src", $(this).attr("data-animate"));
		$(this).attr("data-state","animate");
	}else if(state === "animate"){
		$(this).attr("src", $(this).attr("data-still"));
		$(this).attr("data-state", "still");
	}

});

</script>
</body>
</html>